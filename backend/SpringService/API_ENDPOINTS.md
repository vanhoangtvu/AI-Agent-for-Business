# API Endpoints - Spring Boot Backend

## Base URL
```
http://localhost:8089
```

## 1. Authentication APIs

### Register
```http
POST /api/auth/register
Content-Type: application/json

{
  "username": "user123",
  "password": "password123",
  "email": "user@example.com",
  "fullName": "Nguyen Van A"
}

Response:
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "username": "user123"
}
```

### Login
```http
POST /api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}

Response:
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "username": "admin"
}
```

---

## 2. Document Management APIs

### Upload Document
```http
POST /api/documents/upload
Authorization: Bearer {token}
Content-Type: multipart/form-data

Form Data:
- file: [file]
- category: "sales" (optional)
- tags: "Q1,revenue,2024" (optional)

Response:
{
  "id": 1,
  "fileName": "sales_report.pdf",
  "fileType": "application/pdf",
  "fileSize": 1024000,
  "status": "PENDING",
  "category": "sales",
  "tags": "Q1,revenue,2024",
  "vectorized": false,
  "chunkCount": 0,
  "createdAt": "2024-01-15T10:30:00",
  "processedAt": null
}
```

### Get User Documents
```http
GET /api/documents?page=0&size=10
Authorization: Bearer {token}

Response:
{
  "content": [
    {
      "id": 1,
      "fileName": "sales_report.pdf",
      "fileType": "application/pdf",
      "fileSize": 1024000,
      "status": "PROCESSED",
      "category": "sales",
      "tags": "Q1,revenue,2024",
      "vectorized": true,
      "chunkCount": 45,
      "createdAt": "2024-01-15T10:30:00",
      "processedAt": "2024-01-15T10:32:00"
    }
  ],
  "pageable": {...},
  "totalElements": 1,
  "totalPages": 1
}
```

### Get Single Document
```http
GET /api/documents/{id}
Authorization: Bearer {token}

Response:
{
  "id": 1,
  "fileName": "sales_report.pdf",
  "fileType": "application/pdf",
  "fileSize": 1024000,
  "status": "PROCESSED",
  "category": "sales",
  "tags": "Q1,revenue,2024",
  "vectorized": true,
  "chunkCount": 45,
  "createdAt": "2024-01-15T10:30:00",
  "processedAt": "2024-01-15T10:32:00"
}
```

### Delete Document
```http
DELETE /api/documents/{id}
Authorization: Bearer {token}

Response: 200 OK
```

---

## 3. Chat / Conversation APIs

### Create Conversation
```http
POST /api/chat/conversations?title=Marketing Strategy
Authorization: Bearer {token}

Response:
{
  "id": 1,
  "title": "Marketing Strategy",
  "messageCount": 0,
  "createdAt": "2024-01-15T11:00:00",
  "updatedAt": "2024-01-15T11:00:00"
}
```

### Get All Conversations
```http
GET /api/chat/conversations?page=0&size=10
Authorization: Bearer {token}

Response:
{
  "content": [
    {
      "id": 1,
      "title": "Marketing Strategy",
      "messageCount": 5,
      "createdAt": "2024-01-15T11:00:00",
      "updatedAt": "2024-01-15T11:30:00"
    }
  ],
  "pageable": {...},
  "totalElements": 1,
  "totalPages": 1
}
```

### Get Conversation Details
```http
GET /api/chat/conversations/{id}
Authorization: Bearer {token}

Response:
{
  "id": 1,
  "title": "Marketing Strategy",
  "messageCount": 5,
  "createdAt": "2024-01-15T11:00:00",
  "updatedAt": "2024-01-15T11:30:00"
}
```

### Send Message
```http
POST /api/chat/send
Authorization: Bearer {token}
Content-Type: application/json

{
  "conversationId": 1,
  "message": "Phân tích chiến lược marketing cho sản phẩm mới"
}

Response:
{
  "id": 2,
  "role": "ASSISTANT",
  "content": "AI response processing will be implemented in Python service integration.",
  "timestamp": "2024-01-15T11:05:00"
}
```

### Get Conversation Messages
```http
GET /api/chat/conversations/{id}/messages
Authorization: Bearer {token}

Response:
[
  {
    "id": 1,
    "role": "USER",
    "content": "Phân tích chiến lược marketing cho sản phẩm mới",
    "timestamp": "2024-01-15T11:05:00"
  },
  {
    "id": 2,
    "role": "ASSISTANT",
    "content": "Dựa trên dữ liệu...",
    "timestamp": "2024-01-15T11:05:05"
  }
]
```

### Delete Conversation
```http
DELETE /api/chat/conversations/{id}
Authorization: Bearer {token}

Response: 200 OK
```

---

## 4. Strategic Report APIs

### Generate Report
```http
POST /api/reports/generate
Authorization: Bearer {token}
Content-Type: application/json

{
  "title": "Q1 2024 Business Analysis",
  "reportType": "quarterly_analysis",
  "context": "Analyze sales performance and market trends"
}

Response:
{
  "id": 1,
  "title": "Q1 2024 Business Analysis",
  "reportType": "quarterly_analysis",
  "content": "Strategic report content will be generated by AI service...",
  "summary": "This is a placeholder summary...",
  "createdAt": "2024-01-15T12:00:00"
}
```

### Get All Reports
```http
GET /api/reports?page=0&size=10
Authorization: Bearer {token}

Response:
{
  "content": [
    {
      "id": 1,
      "title": "Q1 2024 Business Analysis",
      "reportType": "quarterly_analysis",
      "content": "Full report content...",
      "summary": "Executive summary...",
      "createdAt": "2024-01-15T12:00:00"
    }
  ],
  "pageable": {...},
  "totalElements": 1,
  "totalPages": 1
}
```

### Get Single Report
```http
GET /api/reports/{id}
Authorization: Bearer {token}

Response:
{
  "id": 1,
  "title": "Q1 2024 Business Analysis",
  "reportType": "quarterly_analysis",
  "content": "Full report content...",
  "summary": "Executive summary...",
  "createdAt": "2024-01-15T12:00:00"
}
```

### Delete Report
```http
DELETE /api/reports/{id}
Authorization: Bearer {token}

Response: 200 OK
```

---

## 5. Activity Log APIs

### Get User Activities
```http
GET /api/activities?page=0&size=20
Authorization: Bearer {token}

Response:
{
  "content": [
    {
      "id": 1,
      "activityType": "DOCUMENT_UPLOAD",
      "description": "Uploaded sales_report.pdf",
      "ipAddress": "192.168.1.100",
      "timestamp": "2024-01-15T10:30:00"
    }
  ],
  "pageable": {...},
  "totalElements": 1,
  "totalPages": 1
}
```

### Get All Activities (Admin)
```http
GET /api/activities/all?page=0&size=20
Authorization: Bearer {token}

Response:
{
  "content": [
    {
      "id": 1,
      "activityType": "LOGIN",
      "description": "User logged in",
      "ipAddress": "192.168.1.100",
      "timestamp": "2024-01-15T09:00:00"
    }
  ],
  "pageable": {...},
  "totalElements": 1,
  "totalPages": 1
}
```

---

## 6. User Management APIs

### Get User Profile
```http
GET /api/users/profile
Authorization: Bearer {token}

Response:
{
  "id": 1,
  "username": "admin",
  "email": "admin@example.com",
  "fullName": "Administrator",
  "phoneNumber": "0123456789",
  "roles": ["ROLE_ADMIN", "ROLE_USER"],
  "createdAt": "2024-01-01T00:00:00"
}
```

### Update Profile
```http
PUT /api/users/profile
Authorization: Bearer {token}
Content-Type: application/json

{
  "email": "newemail@example.com",
  "fullName": "New Full Name",
  "phoneNumber": "0987654321"
}

Response:
{
  "id": 1,
  "username": "admin",
  "email": "newemail@example.com",
  "fullName": "New Full Name",
  "phoneNumber": "0987654321",
  "roles": ["ROLE_ADMIN", "ROLE_USER"],
  "createdAt": "2024-01-01T00:00:00"
}
```

### Change Password
```http
POST /api/users/change-password
Authorization: Bearer {token}
Content-Type: application/json

{
  "currentPassword": "oldpassword123",
  "newPassword": "newpassword456"
}

Response: 200 OK
```

---

## Activity Types Enum
- `LOGIN` - User login
- `LOGOUT` - User logout
- `DOCUMENT_UPLOAD` - Document uploaded
- `DOCUMENT_DELETE` - Document deleted
- `CHAT_MESSAGE` - Chat message sent
- `REPORT_GENERATED` - Strategic report generated
- `PROFILE_UPDATE` - User profile updated

## Document Status Enum
- `PENDING` - Waiting for processing
- `PROCESSING` - Being processed by AI
- `PROCESSED` - Processing completed
- `FAILED` - Processing failed

## Message Role Enum
- `USER` - User message
- `ASSISTANT` - AI assistant response
- `SYSTEM` - System message

---

## Notes
- Tất cả endpoints (trừ `/api/auth/*`) đều cần **JWT token** trong header
- Token có thời hạn **24 giờ**
- Pagination: mặc định `page=0`, `size=10/20`
- File upload: tối đa **10MB**, hỗ trợ `pdf`, `docx`, `doc`, `txt`, `xlsx`
- Tài khoản admin mặc định: `username=admin`, `password=admin123`
